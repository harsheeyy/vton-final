/root/miniconda3/envs/idm/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'clip_sample_range', 'thresholding', 'dynamic_thresholding_ratio', 'variance_type'} was not found in config. Values will be initialized to default values.
The config attributes {'decay': 0.9999, 'inv_gamma': 1.0, 'min_decay': 0.0, 'optimization_step': 37000, 'power': 0.6666666666666666, 'update_after_step': 0, 'use_ema_warmup': False} were passed to UNet2DConditionModel, but are not expected and will be ignored. Please verify your config.json configuration file.
{'dropout', 'reverse_transformer_layers_per_block'} was not found in config. Values will be initialized to default values.
{'dropout', 'attention_type', 'addition_embed_type', 'reverse_transformer_layers_per_block'} was not found in config. Values will be initialized to default values.
Some weights of the model checkpoint were not used when initializing UNet2DConditionModel:
 ['add_embedding.linear_1.bias, add_embedding.linear_1.weight, add_embedding.linear_2.bias, add_embedding.linear_2.weight']
{'image_encoder'} was not found in config. Values will be initialized to default values.
Loading pipeline components...: 100%|██████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 317.28it/s]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:41<00:00,  1.40s/it]
Global_step:  0
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:42<00:00,  1.42s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.43s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.45s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.43s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:42<00:00,  1.43s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.43s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]
Global_step:  50
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!
Images generated!





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]






















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]





















100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:43<00:00,  1.44s/it]

















 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                    | 24/30 [00:35<00:08,  1.47s/it]
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f4096321630>
Traceback (most recent call last):
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1478, in __del__
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1442, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/root/miniconda3/envs/idm/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/root/miniconda3/envs/idm/lib/python3.10/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/root/miniconda3/envs/idm/lib/python3.10/multiprocessing/connection.py", line 936, in wait
    ready = selector.select(timeout)
  File "/root/miniconda3/envs/idm/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
Traceback (most recent call last):
  File "/notebooks/ayna/working_repo/IDM-VTON/train.py", line 392, in <module>
    main()
  File "/notebooks/ayna/working_repo/IDM-VTON/train.py", line 389, in main
    train(args, train_dataloader, model, unet, image_encoder, optimizer, accelerator)
  File "/notebooks/ayna/working_repo/IDM-VTON/train.py", line 211, in train
    images = model(
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/notebooks/ayna/working_repo/IDM-VTON/src/tryon_pipeline.py", line 1799, in __call__
    noise_pred = self.unet(
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/notebooks/ayna/working_repo/IDM-VTON/src/unet_hacked_tryon.py", line 1361, in forward
    sample ,curr_garment_feat_idx= upsample_block(
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/notebooks/ayna/working_repo/IDM-VTON/src/unet_block_hacked_tryon.py", line 2379, in forward
    hidden_states = resnet(hidden_states, temb, scale=lora_scale)
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/diffusers/models/resnet.py", line 255, in forward
    self.conv_shortcut(input_tensor, scale) if not USE_PEFT_BACKEND else self.conv_shortcut(input_tensor)
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/diffusers/models/lora.py", line 358, in forward
    return F.conv2d(
KeyboardInterrupt